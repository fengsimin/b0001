<?php
//Copyright (c) 2016 iFeiwu.com
 class Uploader extends Ifeiwu { function __construct() { } protected function postImage($request_data) { goto grnV4; hECYI: return $this->success('', array("\160\x61\164\150" => $file_save_path, "\151\155\141\147\x65" => $handle->file_dst_name, "\x73\151\x7a\x65" => $handle->file_src_size, "\x77\x69\x64\x74\x68" => $handle->image_src_x, "\x68\x65\151\x67\x68\x74" => $handle->image_src_y, "\164\x79\x70\x65" => $handle->image_dst_type, "\145\x78\x74" => $handle->file_dst_name_ext)); goto iYQec; grnV4: $_FILES["\146\151\154\145"]["\156\x61\155\x65"] = $_POST["\146\151\x6c\145\x5f\156\141\155\145"]; goto wTLpZ; Gcqp1: $_FILES["\x66\151\x6c\145"]["\145\x72\x72\x6f\162"] = $_POST["\x66\151\154\x65\137\x65\x72\162\x6f\162"]; goto rcZzc; wTLpZ: $_FILES["\146\151\154\145"]["\164\171\160\145"] = $_POST["\146\x69\x6c\x65\137\164\171\160\145"]; goto MmWVy; r_VH6: $image_resize = $_POST["\151\155\x61\147\x65\137\162\145\x73\151\172\x65"]; goto oRh4a; txKn1: $jpeg_quality = explode("\54", $_POST["\x6a\x70\145\147\137\x71\x75\141\154\151\x74\171"]); goto eIeSP; dTl4a: Lbonf: goto Mxox2; UG0lP: $handle->Process($upload_root . "\x2f" . $file_save_path); goto WVfPR; yVJdE: DNaaw: goto zrpta; ks_cH: $file_name_body_pre = explode("\x2c", $_POST["\x66\x69\154\145\x5f\156\x61\x6d\145\x5f\142\x6f\144\171\x5f\x70\x72\x65"]); goto RqZH6; iYQec: qCmgk: goto JUN3Q; Nhqmz: if (!$image_convert) { goto Lbonf; } goto mwRcK; y0TK6: if (!($file_save_path == "\x2f")) { goto RZ9Cv; } goto gXS3R; ZS3mE: K00Ow: goto ViBLl; WVfPR: goto MKj00; goto uDj7Y; aWxXB: $file_overwrite = $_POST["\x66\x69\x6c\145\137\157\x76\145\x72\x77\162\151\164\145"]; goto r_VH6; W5NWQ: gPykr: goto QHJQ2; kD3om: goto qCmgk; goto th26y; olGfe: goto o1Tyz; goto h3j_u; gXS3R: $file_save_path = ''; goto Km3l6; zrpta: if ($handle->processed) { goto lf61x; } goto Lqs6y; Lqs6y: return $this->error($handle->log); goto kD3om; h3j_u: GLK4n: goto PEQx6; xSyiy: $handle = new Upload($_FILES["\x66\x69\x6c\x65"]); goto gSYe3; ViBLl: MKj00: goto yVJdE; btJkI: if (!$quality) { goto RafnA; } goto WILhM; dK1OE: foreach ($file_name_body_pre as $key => $prefix) { goto YmB4p; zTZwW: $handle->Process($upload_root . "\x2f" . $file_save_path); goto SXOLr; OqxAU: $handle->jpeg_quality = $quality; goto zMwOS; GJ3aZ: $handle->image_resize = $image_resize ? true : false; goto Qk5k6; MIv9e: if (!$image_convert) { goto V_G0r; } goto MfTY0; pcFRk: $handle->image_y = $height; goto pzuFF; zMwOS: Ygil1: goto MIv9e; POIjQ: $handle->image_ratio_y = true; goto AgNTK; SXOLr: dWF3U: goto XNE70; nc3Qh: t6csF: goto B7Pjx; t7q4d: XHYey: goto glsoH; Ghplm: sN8nl: goto W80SU; AgNTK: goto Lxg1K; goto GBAHJ; ApI5w: $handle->file_overwrite = $file_overwrite ? true : false; goto zTZwW; MfTY0: $handle->image_convert = $image_convert; goto jHDVa; B7Pjx: $handle->image_x = $width; goto t7q4d; E8i7d: if (!$file_new_name_body) { goto gglbV; } goto ayJ89; GBAHJ: cXreL: goto pcFRk; IaKBr: $height = $image_y[$key]; goto F_yPx; glsoH: if ($height && $handle->image_src_y > $height) { goto cXreL; } goto POIjQ; rwNxb: if ($width && $handle->image_src_x > $width) { goto t6csF; } goto OvXRC; O7wbu: gglbV: goto ApI5w; jHDVa: V_G0r: goto rwNxb; wJvzL: goto XHYey; goto nc3Qh; YmB4p: $width = $image_x[$key]; goto IaKBr; Qk5k6: $handle->file_name_body_pre = $prefix; goto Ghplm; ayJ89: $handle->file_new_name_body = $file_new_name_body; goto O7wbu; uUTOl: if (!$prefix) { goto sN8nl; } goto GJ3aZ; OvXRC: $handle->image_x = $handle->image_src_x; goto wJvzL; F_yPx: $quality = $jpeg_quality[$key]; goto uUTOl; W80SU: if (!$quality) { goto Ygil1; } goto OqxAU; pzuFF: Lxg1K: goto E8i7d; XNE70: } goto ZS3mE; rcZzc: if (!empty($_FILES["\x66\151\154\x65"])) { goto GLK4n; } goto C_A_h; Q4KMO: $upload_root = "\56\x2e\x2f"; goto mdfTP; eIeSP: if ($image_resize == 1) { goto FYOui; } goto aqR2Y; mdfTP: $file_new_name_body = $_POST["\x66\151\154\x65\137\x6e\145\167\x5f\x6e\x61\155\145\137\142\x6f\144\171"]; goto aWxXB; C_A_h: return $this->error("\346\227\xa0\xe6\225\210\xe7\232\204\346\x96\x87\344\xbb\xb6\xe4\xbf\xa1\xe6\x81\xaf\357\274\x81"); goto olGfe; RqZH6: $image_x = explode("\54", $_POST["\x69\155\x61\x67\145\137\x78"]); goto EF7uB; PEQx6: ifeiwu\Loader::import("\x65\170\164\x65\x6e\144\57\x55\x70\x6c\x6f\141\144"); goto xSyiy; Km3l6: RZ9Cv: goto hECYI; gb06z: RafnA: goto Nhqmz; MmWVy: $_FILES["\x66\x69\x6c\x65"]["\163\x69\172\x65"] = $_POST["\x66\151\x6c\145\x5f\163\x69\x7a\x65"]; goto Gcqp1; th26y: lf61x: goto y0TK6; uDj7Y: FYOui: goto ks_cH; WILhM: $handle->jpeg_quality = $quality; goto gb06z; oRh4a: $file_save_path = $_POST["\x66\x69\154\x65\137\163\141\166\x65\137\x70\141\164\150"]; goto Sb5_N; Mxox2: if (!$file_new_name_body) { goto gPykr; } goto TQbDf; Sb5_N: $image_convert = $_POST["\x69\x6d\141\x67\x65\x5f\x63\x6f\x6e\166\x65\x72\x74"]; goto txKn1; TQbDf: $handle->file_new_name_body = $file_new_name_body; goto W5NWQ; QHJQ2: $handle->file_overwrite = $file_overwrite ? true : false; goto UG0lP; aqR2Y: $quality = end($jpeg_quality); goto btJkI; mwRcK: $handle->image_convert = $image_convert; goto dTl4a; EF7uB: $image_y = explode("\x2c", $_POST["\x69\155\x61\x67\145\x5f\x79"]); goto dK1OE; JUN3Q: o1Tyz: goto KUXiq; gSYe3: if (!$handle->uploaded) { goto DNaaw; } goto Q4KMO; KUXiq: } protected function postFile($request_data) { goto OOoV4; ET4i6: $_FILES["\146\151\x6c\x65"]["\x65\162\x72\157\x72"] = $_POST["\146\151\x6c\145\137\145\162\162\x6f\162"]; goto mVNO9; rVqxx: $this->_debug("\145\162\162\x6f\162\x20" . $file["\x65\162\x72\x6f\x72"] . "\40\x69\x6e\x20\x66\151\x6c\145\40" . $resumableFilename); goto wmyEW; HQuQX: z8oCQ: goto G2Ml4; VR4xd: $this->_createFileFromChunks($save_path, $temp_dir, $resumableFilename, $_POST["\x72\145\x73\x75\155\x61\x62\x6c\x65\103\150\165\x6e\x6b\x53\x69\x7a\x65"], $_POST["\x72\x65\163\x75\155\141\142\x6c\x65\x54\x6f\x74\141\154\123\151\172\145"]); goto f14Wg; HYODY: $_FILES["\x66\x69\x6c\x65"]["\x6e\141\x6d\145"] = $_POST["\x66\x69\154\145\137\156\141\x6d\x65"]; goto tSFEE; en4z6: $resumableChunkNumber = $_POST["\162\x65\x73\x75\155\x61\142\x6c\x65\103\x68\x75\x6e\153\x4e\x75\155\142\145\x72"]; goto eC4wZ; UGczg: HzXBT: goto gy0xr; E0JHE: $dest_file = $temp_dir . "\57" . $resumableFilename . "\56\x70\x61\162\164" . $resumableChunkNumber; goto L78W6; f14Wg: goto z8oCQ; goto UGczg; gy0xr: $this->_debug("\105\x72\162\157\x72\x20\163\141\x76\151\156\147\x20\50\x6d\x6f\x76\145\137\165\160\154\x6f\x61\144\145\144\137\146\151\x6c\x65\51\40\x63\150\165\x6e\153\x20" . $resumableChunkNumber . "\x20\146\x6f\x72\40\x66\151\x6c\x65\x20" . $resumableFilename); goto HQuQX; vY_Xg: if (!($file["\x65\162\162\157\x72"] != 0)) { goto nEgTz; } goto rVqxx; tSFEE: $_FILES["\146\151\x6c\145"]["\164\171\x70\145"] = $_POST["\x66\x69\154\145\x5f\x74\171\160\145"]; goto sAg2v; L78W6: if (is_dir($temp_dir)) { goto rdTcI; } goto U1toR; eC4wZ: $resumableIdentifier = $_POST["\162\145\163\x75\155\x61\142\x6c\145\x49\144\145\x6e\x74\x69\x66\x69\x65\x72"]; goto HYODY; nJi3n: $temp_dir = $save_path . "\x2f" . $resumableIdentifier; goto E0JHE; o_zI_: if (!move_uploaded_file($file["\164\x6d\160\137\156\x61\155\145"], $dest_file)) { goto HzXBT; } goto VR4xd; TxlQs: $resumableFilename = $this->_UTF82GBK($_POST["\x72\x65\163\165\155\x61\142\154\145\106\151\x6c\x65\156\141\x6d\x65"]); goto en4z6; U1toR: mkdir($temp_dir, 511, true); goto w7H6M; OOoV4: $save_path = "\x2e\56\x2f" . $this->_UTF82GBK($_POST["\163\141\x76\x65\137\x70\141\164\150"]); goto TxlQs; w7H6M: rdTcI: goto o_zI_; sAg2v: $_FILES["\x66\x69\154\x65"]["\163\151\x7a\x65"] = $_POST["\x66\x69\154\x65\x5f\x73\151\x7a\145"]; goto ET4i6; wmyEW: nEgTz: goto nJi3n; mVNO9: $file = $_FILES["\x66\151\154\x65"]; goto vY_Xg; G2Ml4: } protected function getFile() { goto uJrLW; RLy8a: $resumableIdentifier = $_GET["\x72\145\x73\x75\155\x61\142\154\x65\x49\x64\x65\156\x74\x69\146\151\x65\162"]; goto nGrE6; RPYvN: return 202; goto JkGu4; uJrLW: $save_path = "\x2e\x2e\57" . $this->_UTF82GBK($_GET["\163\141\x76\x65\137\x70\x61\x74\x68"]); goto nIzgo; qLKVE: goto YHL5q; goto yPYbQ; yPYbQ: b5fVq: goto RPYvN; US9oR: $resumableChunkNumber = $_GET["\x72\145\163\165\x6d\x61\x62\154\145\x43\x68\x75\x6e\x6b\116\165\155\142\145\x72"]; goto RLy8a; nGrE6: $temp_dir = $save_path . "\x2f" . $resumableIdentifier; goto nDlkA; nIzgo: $resumableFilename = $this->_UTF82GBK($_GET["\x72\145\163\x75\x6d\141\x62\154\x65\106\x69\x6c\145\x6e\141\155\145"]); goto US9oR; PT19_: return 404; goto qLKVE; JkGu4: YHL5q: goto ojz62; nDlkA: $chunk_file = $temp_dir . "\57" . $resumableFilename . "\x2e\160\x61\162\x74" . $resumableChunkNumber; goto gVSel; gVSel: if (file_exists($chunk_file)) { goto b5fVq; } goto PT19_; ojz62: } private function _createFileFromChunks($save_path, $temp_dir, $fileName, $chunkSize, $totalSize) { goto C1QIW; MmnQ7: goto aBkSn; goto UBVzX; si2zE: $i++; goto MmnQ7; vhcP_: if (!($total_files * $chunkSize >= $totalSize - $chunkSize + 1)) { goto qFQa7; } goto RztoH; FBQgx: EN_0L: goto vhcP_; lPKzB: fclose($fp); goto yO08G; yNnBw: vFweS: goto Dsvon; jpZmc: goto vFweS; goto WBqag; UBVzX: jc1Rg: goto lPKzB; WRrbe: $this->_rrmdir($temp_dir); goto jpZmc; b0kzR: if (!($i <= $total_files)) { goto jc1Rg; } goto pCsXN; pmIPY: foreach (scandir($temp_dir) as $file) { goto s_YDW; K9Qeu: HUH3Q: goto Tx_Sc; Q3i7A: $total_files++; goto dIBJi; dIBJi: NRMxy: goto K9Qeu; s_YDW: if (!(stripos($file, $fileName) !== false)) { goto NRMxy; } goto Q3i7A; Tx_Sc: } goto FBQgx; pCsXN: fwrite($fp, file_get_contents($temp_dir . "\57" . $fileName . "\56\160\x61\x72\x74" . $i)); goto WAkcf; WAkcf: g8jNC: goto si2zE; EkV8U: A6n5X: goto fIFoj; E2hiM: $this->_debug("\x63\141\156\x6e\x6f\164\40\143\x72\145\x61\x74\x65\x20\164\150\x65\40\x64\x65\x73\x74\151\x6e\141\x74\151\157\x6e\40\x66\x69\x6c\x65"); goto RNLIB; Dsvon: qFQa7: goto diZZ1; C1QIW: $total_files = 0; goto pmIPY; UMy2j: goto D22H7; goto EkV8U; WBqag: AGPOQ: goto c9f0w; RNLIB: return false; goto UMy2j; RztoH: if (($fp = fopen($save_path . "\57" . $fileName, "\x77")) !== false) { goto A6n5X; } goto E2hiM; dUcDb: aBkSn: goto b0kzR; yO08G: D22H7: goto N5guz; fIFoj: $i = 1; goto dUcDb; N5guz: if (rename($temp_dir, $temp_dir . "\137\125\x4e\x55\123\x45\x44")) { goto AGPOQ; } goto WRrbe; c9f0w: $this->_rrmdir($temp_dir . "\x5f\125\116\125\123\x45\104"); goto yNnBw; diZZ1: } private function _rrmdir($dir) { goto SjzbV; nNnie: biCf3: goto TTCx7; vDrOw: EFBV5: goto OQgVl; UHPbH: rmdir($dir); goto vDrOw; vMY_a: foreach ($objects as $object) { goto Vb0Df; lkQHb: $this->_rrmdir($dir . "\x2f" . $object); goto n9ARL; DwIrJ: unlink($dir . "\x2f" . $object); goto zy8fv; Bjr4Q: cWoUI: goto lkQHb; uXPjp: wBH1S: goto NraHv; Vb0Df: if (!($object != "\x2e" && $object != "\x2e\x2e")) { goto uJtnq; } goto nsaMX; n9ARL: d33MN: goto lt33e; nsaMX: if (filetype($dir . "\57" . $object) == "\144\x69\162") { goto cWoUI; } goto DwIrJ; lt33e: uJtnq: goto uXPjp; zy8fv: goto d33MN; goto Bjr4Q; NraHv: } goto nNnie; SjzbV: if (!is_dir($dir)) { goto EFBV5; } goto B73eQ; B73eQ: $objects = scandir($dir); goto vMY_a; TTCx7: reset($objects); goto UHPbH; OQgVl: } }
